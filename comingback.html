<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üåª Reunion Countdown ‚Äì Oct 20</title>
  <style>
    :root{
      --bg1:#0f172a;     /* slate-900 */
      --bg2:#1e293b;     /* slate-800 */
      --sun:#f59e0b;     /* amber-500 */
      --gold:#fbbf24;    /* amber-400 */
      --pink:#ec4899;    /* pink-500 */
      --cyan:#22d3ee;    /* cyan-400 */
      --white:#ffffff;
      --shadow: 0 8px 30px rgba(0,0,0,.35);
    }

    /* Animated gradient backdrop */
    body{
      margin:0; height:100svh; overflow:hidden; color:var(--white);
      background: linear-gradient(120deg, #0b1020, #0f234a, #193a53, #613c0e, #c77d0a, #0f234a);
      background-size: 400% 400%;
      animation: gradientShift 24s ease-in-out infinite;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    @keyframes gradientShift{
      0%{ background-position: 0% 50%;}
      50%{ background-position: 100% 50%;}
      100%{ background-position: 0% 50%;}
    }

    /* Subtle twinkling stars */
    .stars::before, .stars::after{
      content:""; position:absolute; inset:-10vh; pointer-events:none; opacity:.35;
      background-image: radial-gradient(#fff 0 1px, transparent 1px),
                        radial-gradient(#fff 0 1px, transparent 1px),
                        radial-gradient(#fff 0 1px, transparent 1px);
      background-size: 4px 4px, 3px 3px, 2px 2px;
      background-position: 0 0, 50px 80px, 130px 30px;
      filter: drop-shadow(0 0 6px rgba(255,255,255,.3));
      animation: twinkle 10s linear infinite;
    }
    .stars::after{ animation-duration: 15s; opacity:.25; }
    @keyframes twinkle{ from{transform:translateY(0)} to{transform:translateY(10px)} }

    /* Floating sunflower emojis */
    #petals { position:fixed; inset:0; overflow:hidden; z-index:0; pointer-events:none; }
    .petal {
      position:absolute; will-change: transform, opacity; filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
      animation: floatUp linear forwards;
    }
    @keyframes floatUp{
      0%{ transform: translate(var(--xStart), 110vh) rotate(0deg) scale(var(--scale)); opacity:0; }
      10%{ opacity:1; }
      100%{ transform: translate(var(--xEnd), -20vh) rotate(var(--rot)) scale(var(--scale)); opacity:0; }
    }

    /* Layout */
    .wrap{ position:relative; z-index:1; height:100%; display:grid; justify-items:center; align-content:start; text-align:center; padding: clamp(16px, 3vw, 40px); padding-top: clamp(24px, 8vh, 128px); }
    .panel{
      backdrop-filter: blur(6px) saturate(120%);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.15);
      border-radius: 24px; padding: clamp(18px, 3vw, 28px) clamp(20px, 4vw, 40px);
      box-shadow: var(--shadow);
    }
    h1{ margin:0 0 .25em; font-size: clamp(24px, 3.8vw, 42px); font-weight:800; letter-spacing:.5px; }
    .subtitle{ opacity:.9; margin-bottom: 1.25em; font-size: clamp(14px, 2.4vw, 18px) }

    .big-days{
      font-variant-numeric: tabular-nums; line-height: .95;
      font-size: clamp(64px, 16vw, 180px); font-weight:900;
      text-shadow: 0 6px 20px rgba(0,0,0,.4);
    }
    .time-row{ display:flex; gap: clamp(10px, 3vw, 28px); justify-content:center; margin-top:.5em; flex-wrap:wrap; }
    .tile{
      min-width: clamp(70px, 14vw, 140px);
      padding: .4em .2em .6em; border-radius: 16px;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.15);
      box-shadow: inset 0 0 20px rgba(255,255,255,.04), 0 10px 30px rgba(0,0,0,.25);
    }
    .num{ font-size: clamp(32px, 8vw, 72px); font-weight:800; font-variant-numeric: tabular-nums; }
    .lbl{ opacity:.9; letter-spacing: .12em; font-size: clamp(11px, 2.2vw, 13px); text-transform: uppercase; }

    .tagline{ margin-top: 1em; font-size: clamp(14px, 2.4vw, 18px); opacity:.9 }
    .made{ margin-top: 1.25em; font-size: 12px; opacity:.7 }
    .emoji{ filter: drop-shadow(0 8px 14px rgba(0,0,0,.25)); }

    /* Pulse ring behind the count for subtle emphasis */
    .pulse{
      position:absolute; inset:0; display:grid; place-items:center; pointer-events:none; z-index:0;
    }
    .ring{
      width:min(84vmin, 900px); aspect-ratio:1/1; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,215,96,.18), rgba(255,215,96,0) 60%);
      animation: breathe 6s ease-in-out infinite;
      filter: blur(8px);
    }
    @keyframes breathe{ 0%{transform:scale(.96)} 50%{transform:scale(1.02)} 100%{transform:scale(.96)} }

    /* Today ribbon */
    .today{ display:inline-block; margin-top:10px; padding:.35em .7em; border-radius:999px; background:rgba(34,211,238,.22); border:1px solid rgba(34,211,238,.5); font-weight:600; }

    /* Accessible hidden label */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    /* Audio controls styling */
    .audio-controls{ position:fixed; top:20px; right:20px; z-index:100; display:flex; align-items:center; gap:10px; }
    .audio-btn{ 
      width:48px; height:48px; border-radius:50%; border:2px solid rgba(255,255,255,.3);
      background:rgba(0,0,0,.4); backdrop-filter:blur(8px); color:var(--white);
      display:flex; align-items:center; justify-content:center; cursor:pointer;
      transition:all .3s ease; font-size:18px;
    }
    .audio-btn:hover{ background:rgba(255,255,255,.15); border-color:rgba(255,255,255,.5); transform:scale(1.05); }
    .volume-control{ 
      opacity:0; width:0; transition:all .3s ease; overflow:hidden;
      background:rgba(0,0,0,.4); backdrop-filter:blur(8px); border-radius:20px; padding:8px 0;
    }
    .audio-controls:hover .volume-control{ opacity:1; width:100px; padding:8px 12px; }
    .volume-slider{ 
      width:100%; height:4px; background:rgba(255,255,255,.3); border-radius:2px; outline:none; cursor:pointer;
      -webkit-appearance:none; appearance:none;
    }
    .volume-slider::-webkit-slider-thumb{ 
      -webkit-appearance:none; width:14px; height:14px; border-radius:50%; 
      background:var(--gold); cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,.3);
    }
    .volume-slider::-moz-range-thumb{ 
      width:14px; height:14px; border-radius:50%; background:var(--gold); 
      cursor:pointer; border:none; box-shadow:0 2px 6px rgba(0,0,0,.3);
    }

      /* --- Reunion Journey Scene (girl + cyclist) --- */
    .scene{ position:fixed; inset:0; z-index:0; pointer-events:none; }
    .girl{ position:absolute; bottom:13vh; right:6vw; font-size:clamp(56px,12vmin,140px); transform-origin:bottom center; filter: drop-shadow(0 10px 24px rgba(0,0,0,.45)); animation:sway 5s ease-in-out infinite; }
    .biker{ position:absolute; bottom:12vh; left:4vw; transform: translateX(calc(var(--journey-progress,0) * (100vw - 24vw))); }
    .biker-emoji{ display:inline-block; font-size:clamp(48px,11vmin,128px); filter: drop-shadow(0 10px 24px rgba(0,0,0,.45)); transform: scaleX(-1); }

    .pedal{ display:inline-block; animation:pedal 1.1s ease-in-out infinite; }

    .road{ position:absolute; left:0; right:0; bottom:0; height:14vh; background:linear-gradient(180deg, rgba(20,20,20,0) 0%, rgba(12,12,12,.65) 30%, rgba(8,8,8,.9) 100%); }
    .road::after{ content:""; position:absolute; left:0; right:0; top:48%; height:8px; opacity:.7;
      background: repeating-linear-gradient(90deg, rgba(255,255,255,.95) 0 60px, rgba(255,255,255,0) 60px 120px);
      animation: dash 1.6s linear infinite; }

    .sunflower-row{ position:absolute; bottom:14vh; width:100%; text-align:center; opacity:.35; }
    .sunflower-row span{ display:inline-block; margin:0 .25em; font-size:clamp(14px,3vmin,28px); animation:sway 4s ease-in-out infinite; }

    @keyframes dash{ from{ background-position-x:0 } to{ background-position-x:-240px } }
    @keyframes sway{ 0%{ transform:rotate(-2deg)} 50%{ transform:rotate(2deg)} 100%{ transform:rotate(-2deg)} }
    @keyframes pedal{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-6px) } }

    @media (prefers-reduced-motion: reduce){
      .girl, .biker-emoji, .road::after, .sunflower-row span{ animation:none !important; }
    }
  </style>
</head>
<body>
  <div class="scene" aria-hidden="true">
    <div class="sunflower-row" aria-hidden="true"></div>
    <div class="girl" role="img" aria-label="Girl waiting">üëß</div>
    <div class="biker" aria-hidden="true"><span class="biker-emoji" role="img" aria-label="Guy on a bicycle"><span class="pedal">üö¥‚Äç‚ôÇÔ∏è</span></span></div>
    <div class="road"></div>
  </div>
  <div class="stars" aria-hidden="true"></div>
  <div id="petals" aria-hidden="true"></div>

  <!-- Audio controls -->
  <div class="audio-controls">
    <button class="audio-btn" id="playPauseBtn" title="Play/Pause music">‚ñ∂Ô∏è</button>
    <div class="volume-control">
      <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70" title="Volume">
    </div>
  </div>

  <!-- Hidden audio element -->
  <audio id="bgMusic" loop preload="auto">
    <source src="favourite.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <main class="wrap">
    <div class="pulse"><div class="ring"></div></div>

    <section class="panel" role="group" aria-labelledby="heading" aria-live="polite">
      <h1 id="heading">üåª Until We&#39;re Together Again</h1>
      <div class="subtitle">Counting down to <strong>October 20, 2025</strong> üíõ</div>

      <div class="big-days" id="days">00</div>
      <div class="time-row" aria-hidden="false">
        <div class="tile"><div class="num" id="hours">00</div><div class="lbl">Hours</div></div>
        <div class="tile"><div class="num" id="mins">00</div><div class="lbl">Minutes</div></div>
        <div class="tile"><div class="num" id="secs">00</div><div class="lbl">Seconds</div></div>
      </div>
      <div class="tagline">üåû + üåª = üíñ</div>
    </section>
  </main>

  <script>
    // === CONFIG ===
    // Target moment in America/Guatemala time (UTC-06:00). Change easily if needed.
    const TARGET_ISO = '2025-10-20T00:00:00-06:00';
    const target = new Date(TARGET_ISO);

    // === Journey progress (cyclist moves closer each day) ===
    const urlParams = new URLSearchParams(location.search);
    const journeyStartParam = urlParams.get('journeyStart');
    // Default journey start: 60 days before the target, overridable via ?journeyStart=YYYY-MM-DD
    const journeyStart = journeyStartParam ? new Date(journeyStartParam + 'T00:00:00-06:00') : new Date(target.getTime() - 60 * 86400000);

    const sunflowerRow = document.querySelector('.sunflower-row');
    if(sunflowerRow){
      // Populate a row of swaying sunflowers üåª
      for(let i=0;i<60;i++){
        const s = document.createElement('span');
        s.textContent = 'üåª';
        s.style.animationDelay = (Math.random()*4).toFixed(2)+'s';
        sunflowerRow.appendChild(s);
      }
    }

    function clamp01(x){ return Math.max(0, Math.min(1, x)); }
    function getJourneyProgress(now){
      if(now < journeyStart) return 0;
      const totalMs = Math.max(1, target - journeyStart);
      const remainingMs = Math.max(0, target - now);
      const p = 1 - (remainingMs / totalMs);
      return clamp01(p);
    }
    function updateJourney(now){
      const p = getJourneyProgress(now);
      document.documentElement.style.setProperty('--journey-progress', p.toFixed(4));
    }

    const daysEl = document.getElementById('days');
    const hEl = document.getElementById('hours');
    const mEl = document.getElementById('mins');
    const sEl = document.getElementById('secs');

    function pad(n){ return String(n).padStart(2,'0'); }

    function diffParts(to){
      const now = new Date();
      let ms = to - now;
      if(ms < 0) ms = 0;
      const sec = Math.floor(ms/1000);
      const days = Math.floor(sec / 86400);
      const hours = Math.floor((sec % 86400) / 3600);
      const mins = Math.floor((sec % 3600) / 60);
      const secs = sec % 60;
      return {ms, days, hours, mins, secs};
    }

    function tick(){
      updateJourney(new Date());
      const {ms, days, hours, mins, secs} = diffParts(target);
      daysEl.textContent = days;
      hEl.textContent = pad(hours);
      mEl.textContent = pad(mins);
      sEl.textContent = pad(secs);
      document.title = `üåª ${days}d ${pad(hours)}:${pad(mins)}:${pad(secs)} ‚Äì Reunion`;

      if(ms === 0){
        celebrateToday();
        clearInterval(timer);
      }
    }

    const timer = setInterval(tick, 1000);
    tick();

    // === Celebration when countdown hits zero ===
    let celebrated = false;
    function celebrateToday(){
      if(celebrated) return; celebrated = true;
      const heading = document.getElementById('heading');
      heading.textContent = 'üåª It\'s Today!';
      const subtitle = document.querySelector('.subtitle');
      subtitle.innerHTML = "Have the best reunion ever. üíû";
      const tagline = document.querySelector('.tagline');
      tagline.innerHTML = '<span class="today">Together at last</span>';
      // Bring the cyclist all the way to the right
      document.documentElement.style.setProperty('--journey-progress','1');
      // Sweet little hug moment üíë
      const bikerEmoji = document.querySelector('.biker-emoji');
      const girl = document.querySelector('.girl');
      setTimeout(()=>{
        if(bikerEmoji){ bikerEmoji.textContent = 'üíë'; bikerEmoji.style.transform = 'scale(1.08)'; }
        if(girl){ girl.style.opacity = '0'; }
      }, 800);
      burstEmojis(['üåª','üíõ','üíê','‚ú®','‚òÄÔ∏è']);
    }

    function burstEmojis(symbols){
      const root = document.getElementById('petals');
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      const COUNT = 80;
      for(let i=0;i<COUNT;i++){
        const el = document.createElement('div');
        el.className = 'petal';
        el.textContent = symbols[i % symbols.length];
        const angle = Math.random() * Math.PI * 2;
        const dist = 40 + Math.random() * 420;
        const x = Math.cos(angle) * dist;
        const y = Math.sin(angle) * dist;
        el.style.left = centerX + 'px';
        el.style.top = centerY + 'px';
        el.style.transition = 'transform 900ms cubic-bezier(.16,1,.3,1), opacity 900ms linear';
        root.appendChild(el);
        requestAnimationFrame(()=>{
          el.style.transform = `translate(${x}px, ${y}px) scale(${0.8 + Math.random()*0.8}) rotate(${(Math.random()*720-360)}deg)`;
          el.style.opacity = '0';
        });
        setTimeout(()=> el.remove(), 1200);
      }
    }

    // === Continuous floating sunflower field ===
    const field = document.getElementById('petals');
    const EMOJIS = ['üåª','‚òÄÔ∏è','‚ú®'];

    function spawnSunflower(){
      const el = document.createElement('div');
      el.className = 'petal';
      el.textContent = EMOJIS[Math.random()*EMOJIS.length | 0];

      const xStart = Math.random()*100;       // vw
      const xEnd = xStart + (Math.random()*20 - 10);
      const scale = 0.8 + Math.random()*1.2;  // 0.8 - 2.0
      const rot = (Math.random() < .5 ? -1 : 1) * (180 + Math.random()*540);
      const dur = 16 + Math.random()*22;      // seconds

      el.style.setProperty('--xStart', xStart + 'vw');
      el.style.setProperty('--xEnd', xEnd + 'vw');
      el.style.setProperty('--scale', scale);
      el.style.setProperty('--rot', rot + 'deg');
      el.style.fontSize = (24 + Math.random()*56) + 'px';
      el.style.animationDuration = dur + 's';
      el.style.opacity = '0';

      field.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }

    // spawn a few per second
    const density = 6; // change for more/less üåª
    setInterval(()=>{ for(let i=0;i<density;i++) spawnSunflower(); }, 1200);

    // Reduce motion if user prefers
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    if(mediaQuery.matches){
      document.querySelectorAll('*').forEach(el=> el.style.animationDuration && (el.style.animationDuration = '0s'));
    }

    // === Audio controls ===
    const bgMusic = document.getElementById('bgMusic');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const volumeSlider = document.getElementById('volumeSlider');

    let isPlaying = false;
    
    // Set initial volume
    bgMusic.volume = volumeSlider.value / 100;

    // Play/Pause functionality
    playPauseBtn.addEventListener('click', () => {
      if (isPlaying) {
        bgMusic.pause();
        playPauseBtn.textContent = '‚ñ∂Ô∏è';
        playPauseBtn.title = 'Play music';
        isPlaying = false;
      } else {
        const playPromise = bgMusic.play();
        if (playPromise !== undefined) {
          playPromise.then(() => {
            playPauseBtn.textContent = '‚è∏Ô∏è';
            playPauseBtn.title = 'Pause music';
            isPlaying = true;
          }).catch(error => {
            console.log('Audio play failed:', error);
            // Handle autoplay restrictions
            showAudioPrompt();
          });
        }
      }
    });

    // Volume control
    volumeSlider.addEventListener('input', () => {
      bgMusic.volume = volumeSlider.value / 100;
    });

    // Handle audio events
    bgMusic.addEventListener('ended', () => {
      playPauseBtn.textContent = '‚ñ∂Ô∏è';
      playPauseBtn.title = 'Play music';
      isPlaying = false;
    });

    // Auto-play attempt (may be blocked by browser)
    function attemptAutoPlay() {
      const playPromise = bgMusic.play();
      if (playPromise !== undefined) {
        playPromise.then(() => {
          playPauseBtn.textContent = '‚è∏Ô∏è';
          playPauseBtn.title = 'Pause music';
          isPlaying = true;
        }).catch(() => {
          // Autoplay was prevented, keep play button visible
          playPauseBtn.textContent = '‚ñ∂Ô∏è';
          playPauseBtn.title = 'Click to play music';
        });
      }
    }

    // Try autoplay after page loads
    window.addEventListener('load', () => {
      setTimeout(attemptAutoPlay, 1000);
    });

    // Show a subtle prompt if autoplay fails
    function showAudioPrompt() {
      const tagline = document.querySelector('.tagline');
      const originalText = tagline.innerHTML;
      tagline.innerHTML = 'üéµ Click the play button to enjoy the music üéµ';
      setTimeout(() => {
        tagline.innerHTML = originalText;
      }, 4000);
    }

    // Allow quick customization via URL params, e.g. ?title=Marco%20%26%20Wife&emoji=üåª
    const params = new URLSearchParams(location.search);
    const titleParam = params.get('title');
    if(titleParam){ document.getElementById('heading').textContent = titleParam; }
    const emojiParam = params.get('emoji');
    if(emojiParam){ EMOJIS.splice(0, EMOJIS.length, ...emojiParam.split(',')); }
  </script>
</body>
</html>
